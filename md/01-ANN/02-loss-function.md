# 损失函数

## 模型推理的误差

一天的工作结束之后，作为冰淇淋店老板的你统计出来今天冰淇淋的销量是120。

```python
# 实际结果（冰淇淋销量）
actual = 120
```

这和之前模型推理的预测结果116略有不同。

## 损失函数

预测结果与实际结果之间可能存在或大或小的误差，多种方法可以用来衡量这种误差。对于线性回归模型最常用的是平均平方差（MSE），公式为：

$\text{MSE} = \frac{1}{n} \sum_{i=1}^{n} (\hat{y}_i - y_i)^2$

其中，$\hat{y}$ 是预测结果，而 $y$ 是实际结果。 

在机器学习中，我们把这类公式称之为损失函数。在模型训练（参数学习）阶段，损失函数主要用来指导模型优化；而在模型推理（结果预测）阶段，损失函数主要用来衡量模型优劣。

```python
# 损失函数（平均平方差）
def mse_loss(p, y):
    return ((p - y) ** 2).mean()
```

现在，作为冰淇淋店老板的你可以衡量预测的准确性了。

```python
# 模型评价
error = mse_loss(prediction, actual)
print(f'误差：{error:.4f}')
```
*误差：852.6400*
